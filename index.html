<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Vigo Chat</title>
  <style>
    :root{
      --bg1:#f7efe4;
      --bg2:#f3e7d8;
      --card: rgba(255,255,255,.75);
      --stroke: rgba(0,0,0,.07);
      --text:#141414;
      --muted: rgba(0,0,0,.55);
      --accent:#2a7cff;
      --accent2:#ffb347;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius:18px;
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-top: env(safe-area-inset-top, 0px);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 20% 5%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(900px 600px at 90% 15%, rgba(255,255,255,.75), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    .app{
      max-width:520px;
      margin:0 auto;
      height:100vh;
      display:flex;
      flex-direction:column;
      padding-top:calc(10px + var(--safe-top));
      padding-bottom:calc(86px + var(--safe-bottom));
    }

    header{
      padding:14px 16px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    header .title{display:flex; flex-direction:column; gap:2px; min-width:0}
    header h1{margin:0; font-size:22px; letter-spacing:.2px}
    header small{color:var(--muted)}
    .pill{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.55);
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 6px 18px rgba(0,0,0,.05);
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:700;
    }
    .pill:active{transform:scale(.98)}

    .views{flex:1; overflow:hidden; padding:0 12px;}
    .view{display:none; height:100%; overflow:auto; padding:6px 4px 10px;}
    .view.active{display:block}

    .card{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:14px;
      margin-bottom:12px;
    }
    .card h3{margin:0 0 6px; font-size:18px}
    .muted{color:var(--muted)}

    .list{display:flex; flex-direction:column; gap:10px; margin-top:8px}
    .row{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.55);
      cursor:pointer;
      user-select:none;
    }
    .row:active{transform:scale(.99)}
    .avatar{
      width:44px; height:44px; border-radius:14px;
      display:grid; place-items:center;
      background:rgba(42,124,255,.12);
      border:1px solid rgba(42,124,255,.18);
      font-weight:900;
      color:var(--accent);
      flex:0 0 auto;
    }
    .row .meta{min-width:0; flex:1}
    .row .meta .name{font-weight:900}
    .row .meta .sub{color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
    .row .time{color:var(--muted); font-size:12px; flex:0 0 auto}

    /* Bottom nav */
    .nav{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:calc(12px + var(--safe-bottom));
      width:min(520px, calc(100vw - 24px));
      background:rgba(255,255,255,.65);
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      border-radius:22px;
      display:flex;
      padding:8px;
      gap:8px;
      backdrop-filter: blur(10px);
    }
    .nav button{
      flex:1;
      border:0;
      background:transparent;
      padding:10px 10px;
      border-radius:18px;
      cursor:pointer;
      font-weight:800;
      color:var(--muted);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
      user-select:none;
    }
    .nav button .ico{font-size:18px; line-height:1}
    .nav button.active{
      background:rgba(42,124,255,.14);
      color:var(--accent);
      border:1px solid rgba(42,124,255,.22);
    }
    .nav button:active{transform:scale(.98)}

    /* Chat screen */
    .chatTop{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius:18px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.55);
      margin-bottom:10px;
      position:sticky; top:0;
      backdrop-filter: blur(10px);
      z-index:5;
    }
    .backBtn{
      border:0;
      background:rgba(0,0,0,.06);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .backBtn:active{transform:scale(.98)}
    .chatName{font-weight:900}
    .chatSub{font-size:12px; color:var(--muted)}
    .bubbleWrap{display:flex; flex-direction:column; gap:8px; padding:6px 2px 12px}
    .b{
      max-width:82%;
      padding:10px 12px;
      border-radius:18px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.72);
      box-shadow: 0 6px 18px rgba(0,0,0,.05);
    }
    .b.me{
      margin-left:auto;
      background:rgba(42,124,255,.14);
      border-color:rgba(42,124,255,.18);
    }
    .b .t{font-size:14px; line-height:1.35}
    .b .s{margin-top:4px; font-size:11px; color:var(--muted)}

    .composer{
      position:sticky;
      bottom:0;
      padding:10px 0 2px;
      background:linear-gradient(180deg, transparent, rgba(243,231,216,.85) 35%, rgba(243,231,216,1));
      z-index:6;
    }
    .composeRow{
      display:flex; gap:8px; align-items:center;
      padding:10px;
      border-radius:18px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.65);
      backdrop-filter: blur(10px);
    }
    .composeRow input{
      flex:1;
      border:0;
      outline:none;
      background:transparent;
      font-size:15px;
      padding:8px;
    }
    .sendBtn{
      border:0;
      cursor:pointer;
      font-weight:900;
      padding:10px 12px;
      border-radius:14px;
      background:rgba(42,124,255,.16);
      color:var(--accent);
      border:1px solid rgba(42,124,255,.22);
    }
    .sendBtn:active{transform:scale(.98)}

    /* Modal */
    .modalBg{
      position:fixed; inset:0;
      background:rgba(0,0,0,.28);
      display:none;
      align-items:center; justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modalBg.show{display:flex}
    .modal{
      width:min(520px, 100%);
      background:rgba(255,255,255,.92);
      border:1px solid var(--stroke);
      border-radius:22px;
      box-shadow: var(--shadow);
      padding:14px;
    }
    .modal h3{margin:0 0 10px}
    .modal input{
      width:100%;
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:12px;
      font-size:15px;
      outline:none;
      background:rgba(255,255,255,.8);
    }
    .modalActions{display:flex; gap:10px; margin-top:12px}
    .btn{
      flex:1;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.06);
      border-radius:14px;
      padding:12px;
      font-weight:900;
      cursor:pointer;
    }
    .btn.primary{
      background:rgba(42,124,255,.16);
      border-color:rgba(42,124,255,.22);
      color:var(--accent);
    }
    .btn:active{transform:scale(.99)}
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="title">
        <h1 id="headerTitle">Mesajlar</h1>
        <small id="headerSub">Basit mesajla≈üma</small>
      </div>
      <div class="pill" id="newBtn" title="Yeni sohbet">
        <span style="font-size:18px">Ôºã</span> Yeni
      </div>
    </header>

    <div class="views">
      <!-- MESSAGES -->
      <section class="view active" id="view-messages">
        <div class="card">
          <h3>Mesajlar</h3>
          <div class="muted">Bir sohbet se√ß ‚Äî mesaj yazƒ±p g√∂nderebilirsin.</div>
        </div>
        <div class="list" id="chatList"></div>
      </section>

      <!-- STATUS -->
      <section class="view" id="view-status">
        <div class="card">
          <h3>Durum</h3>
          <div class="muted">Buraya hikaye/durum mantƒ±ƒüƒ± eklenir (demo).</div>
        </div>

        <div class="list">
          <div class="row" id="addStatus">
            <div class="avatar">‚ú®</div>
            <div class="meta">
              <div class="name">Senin durumun</div>
              <div class="sub">Durum ekle</div>
            </div>
          </div>

          <div class="row">
            <div class="avatar" style="background:rgba(255,180,71,.18); border-color:rgba(255,180,71,.25); color:#9a5a00;">üìå</div>
            <div class="meta">
              <div class="name">Ahmet</div>
              <div class="sub">‚ÄúDƒ±≈üarƒ±dayƒ±m‚Äù</div>
            </div>
          </div>
        </div>
      </section>

      <!-- CALLS -->
      <section class="view" id="view-calls">
        <div class="card">
          <h3>Aramalar</h3>
          <div class="muted">Son aramalar burada g√∂r√ºnecek (demo).</div>
        </div>

        <div class="list">
          <div class="row">
            <div class="avatar">üë§</div>
            <div class="meta">
              <div class="name">Ahmet</div>
              <div class="sub">Bug√ºn 12:05 ‚Ä¢ Gelen</div>
            </div>
          </div>
          <div class="row">
            <div class="avatar">üë§</div>
            <div class="meta">
              <div class="name">Zeynep</div>
              <div class="sub">D√ºn 21:18 ‚Ä¢ Giden</div>
            </div>
          </div>
        </div>
      </section>

      <!-- PROFILE -->
      <section class="view" id="view-profile">
        <div class="card">
          <h3>Profil</h3>
          <div class="muted">Basit profil ekranƒ± (demo).</div>
        </div>

        <div class="list">
          <div class="row">
            <div class="avatar" style="background:rgba(0,0,0,.06); border-color:rgba(0,0,0,.09); color:#111;">üôÇ</div>
            <div class="meta">
              <div class="name">Engin</div>
              <div class="sub">Durum: √ßevrimi√ßi</div>
            </div>
          </div>

          <div class="row" id="openSettings">
            <div class="avatar" style="background:rgba(0,0,0,.06); border-color:rgba(0,0,0,.09); color:#111;">‚öôÔ∏è</div>
            <div class="meta">
              <div class="name">Ayarlar</div>
              <div class="sub">Bildirim / Gizlilik (demo)</div>
            </div>
          </div>
        </div>
      </section>

      <!-- CHAT SCREEN -->
      <section class="view" id="view-chat">
        <div class="chatTop">
          <button class="backBtn" id="backToList">‚Üê</button>
          <div style="min-width:0">
            <div class="chatName" id="chatTitle">Sohbet</div>
            <div class="chatSub" id="chatSubtitle">yazƒ±≈üma</div>
          </div>
        </div>

        <div class="bubbleWrap" id="bubbleWrap"></div>

        <div class="composer">
          <div class="composeRow">
            <input id="msgInput" placeholder="Mesaj yaz..." autocomplete="off"/>
            <button class="sendBtn" id="sendBtn">G√∂nder</button>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Bottom Nav -->
  <nav class="nav" id="bottomNav">
    <button class="active" data-go="messages"><div class="ico">üí¨</div><div>Mesajlar</div></button>
    <button data-go="status"><div class="ico">‚ùó</div><div>Durum</div></button>
    <button data-go="calls"><div class="ico">üë•</div><div>Aramalar</div></button>
    <button data-go="profile"><div class="ico">ü§î</div><div>Profil</div></button>
  </nav>

  <!-- Modal -->
  <div class="modalBg" id="modalBg">
    <div class="modal">
      <h3>Yeni sohbet</h3>
      <input id="newName" placeholder="Ki≈üi adƒ± (√∂r: Ali)"/>
      <div class="modalActions">
        <button class="btn" id="cancelModal">Vazge√ß</button>
        <button class="btn primary" id="createChat">Olu≈ütur</button>
      </div>
    </div>
  </div>

  <script>
    // --------- Helpers ----------
    const $ = (q)=>document.querySelector(q);
    const $$ = (q)=>Array.from(document.querySelectorAll(q));
    const storeKey = "vigo_chat_v1";

    function nowTime(){
      const d = new Date();
      const hh = String(d.getHours()).padStart(2,"0");
      const mm = String(d.getMinutes()).padStart(2,"0");
      return `${hh}:${mm}`;
    }

    function loadState(){
      try{
        const raw = localStorage.getItem(storeKey);
        if(!raw) return null;
        return JSON.parse(raw);
      }catch(e){ return null; }
    }

    function saveState(s){
      localStorage.setItem(storeKey, JSON.stringify(s));
    }

    // --------- App State ----------
    let state = loadState() || {
      chats: [
        { id:"ahmet", name:"Ahmet", last:"Nasƒ±lsƒ±n?", messages:[
          {me:false, text:"Nasƒ±lsƒ±n?", time:"12:03"},
        ]},
        { id:"zeynep", name:"Zeynep", last:"Yarƒ±n g√∂r√º≈ü√ºr√ºz.", messages:[
          {me:false, text:"Yarƒ±n g√∂r√º≈ü√ºr√ºz.", time:"21:18"},
        ]},
        { id:"mert", name:"Mert", last:"Tamamdƒ±r.", messages:[
          {me:false, text:"Tamamdƒ±r.", time:"09:40"},
        ]},
      ]
    };

    let currentChatId = null;

    // --------- UI refs ----------
    const headerTitle = $("#headerTitle");
    const headerSub = $("#headerSub");
    const views = {
      messages: $("#view-messages"),
      status: $("#view-status"),
      calls: $("#view-calls"),
      profile: $("#view-profile"),
      chat: $("#view-chat"),
    };

    function setHeader(title, sub){
      headerTitle.textContent = title;
      headerSub.textContent = sub || "";
    }

    function showView(name){
      Object.values(views).forEach(v=>v.classList.remove("active"));
      views[name].classList.add("active");

      // Header behavior
      if(name === "messages"){ setHeader("Mesajlar","Basit mesajla≈üma"); $("#newBtn").style.display="flex"; }
      if(name === "status"){ setHeader("Durum","Basit mesajla≈üma"); $("#newBtn").style.display="none"; }
      if(name === "calls"){ setHeader("Aramalar","Basit mesajla≈üma"); $("#newBtn").style.display="none"; }
      if(name === "profile"){ setHeader("Profil","Basit mesajla≈üma"); $("#newBtn").style.display="none"; }
      if(name === "chat"){ $("#newBtn").style.display="none"; }
    }

    function setNavActive(name){
      $$("#bottomNav button").forEach(b=>b.classList.remove("active"));
      const btn = $(`#bottomNav button[data-go="${name}"]`);
      if(btn) btn.classList.add("active");
    }

    // --------- Render Chat List ----------
    function renderList(){
      const list = $("#chatList");
      list.innerHTML = "";
      state.chats.forEach(c=>{
        const first = (c.name || "?").trim().charAt(0).toUpperCase() || "?";
        const row = document.createElement("div");
        row.className = "row";
        row.innerHTML = `
          <div class="avatar">${first}</div>
          <div class="meta">
            <div class="name">${escapeHtml(c.name)}</div>
            <div class="sub">${escapeHtml(c.last || "")}</div>
          </div>
          <div class="time">${escapeHtml(c.time || "")}</div>
        `;
        row.addEventListener("click", ()=>openChat(c.id));
        list.appendChild(row);
      });
      saveState(state);
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // --------- Chat Screen ----------
    function openChat(id){
      currentChatId = id;
      const chat = state.chats.find(x=>x.id===id);
      if(!chat) return;

      $("#chatTitle").textContent = chat.name;
      $("#chatSubtitle").textContent = "mesajla≈üma";

      renderBubbles();
      showView("chat");
      // nav highlight stays on messages
      setNavActive("messages");
      // scroll to bottom
      setTimeout(()=> {
        views.chat.scrollTop = views.chat.scrollHeight;
        $("#msgInput").focus();
      }, 50);
    }

    function renderBubbles(){
      const wrap = $("#bubbleWrap");
      wrap.innerHTML = "";
      const chat = state.chats.find(x=>x.id===currentChatId);
      if(!chat) return;

      chat.messages.forEach(m=>{
        const b = document.createElement("div");
        b.className = "b" + (m.me ? " me" : "");
        b.innerHTML = `<div class="t">${escapeHtml(m.text)}</div><div class="s">${escapeHtml(m.time || "")}</div>`;
        wrap.appendChild(b);
      });

      // keep last text
      chat.last = chat.messages.at(-1)?.text || chat.last || "";
      saveState(state);
    }

    function sendMessage(){
      const input = $("#msgInput");
      const text = (input.value || "").trim();
      if(!text) return;

      const chat = state.chats.find(x=>x.id===currentChatId);
      if(!chat) return;

      chat.messages.push({me:true, text, time: nowTime()});
      chat.last = text;
      input.value = "";
      renderBubbles();

      // scroll down
      setTimeout(()=> {
        views.chat.scrollTop = views.chat.scrollHeight;
      }, 50);
    }

    // --------- Modal New Chat ----------
    const modalBg = $("#modalBg");
    function openModal(){
      $("#newName").value = "";
      modalBg.classList.add("show");
      setTimeout(()=>$("#newName").focus(), 50);
    }
    function closeModal(){ modalBg.classList.remove("show"); }

    function createChat(){
      const name = ($("#newName").value || "").trim();
      if(!name) return;

      const id = "c_" + Math.random().toString(16).slice(2);
      state.chats.unshift({
        id, name,
        last:"Sohbet ba≈ülatƒ±ldƒ±.",
        time: nowTime(),
        messages:[
          {me:false, text:"Sohbet ba≈ülatƒ±ldƒ±.", time: nowTime()}
        ]
      });
      saveState(state);
      renderList();
      closeModal();
      openChat(id);
    }

    // --------- Events ----------
    // Bottom nav clicks
    $$("#bottomNav button").forEach(btn=>{
      btn.addEventListener("click", (e)=>{
        const go = btn.getAttribute("data-go");
        if(!go) return;
        setNavActive(go);
        showView(go);
      }, {passive:true});
    });

    // Header new chat button
    $("#newBtn").addEventListener("click", openModal);

    // Modal actions
    $("#cancelModal").addEventListener("click", closeModal);
    modalBg.addEventListener("click", (e)=>{
      if(e.target === modalBg) closeModal();
    });
    $("#createChat").addEventListener("click", createChat);
    $("#newName").addEventListener("keydown", (e)=>{
      if(e.key === "Enter") createChat();
    });

    // Back
    $("#backToList").addEventListener("click", ()=>{
      showView("messages");
      setNavActive("messages");
    });

    // Send
    $("#sendBtn").addEventListener("click", sendMessage);
    $("#msgInput").addEventListener("keydown", (e)=>{
      if(e.key === "Enter") sendMessage();
    });

    // Demo clicks
    $("#addStatus").addEventListener("click", ()=>alert("Durum ekleme: demo."));
    $("#openSettings").addEventListener("click", ()=>alert("Ayarlar: demo."));

    // Init
    renderList();
    showView("messages");
    setNavActive("messages");
  </script>
</body>
</html>
