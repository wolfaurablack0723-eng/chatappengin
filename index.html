<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Vigo Chat</title>
  <style>
    :root{
      --bg1:#fff7ee;
      --bg2:#f7efe6;
      --card: rgba(255,255,255,.78);
      --stroke: rgba(0,0,0,.08);
      --text:#151515;
      --muted: rgba(0,0,0,.55);
      --accent:#2a7cff;
      --accent2:#ffb347;
      --shadow: 0 10px 30px rgba(0,0,0,.07);
      --radius: 18px;

      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 60% 10%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(900px 600px at 10% 90%, rgba(255,255,255,.7), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    .app{
      height:100%;
      max-width:520px;
      margin:0 auto;
      display:flex;
      flex-direction:column;
      padding-top: calc(10px + var(--safe-top));
      padding-bottom: calc(86px + var(--safe-bottom));
    }

    /* Header */
    header{
      padding: 10px 14px 8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .title{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }
    .title h1{
      margin:0;
      font-size:20px;
      letter-spacing:.2px;
      line-height:1.1;
    }
    .title small{
      color:var(--muted);
      font-size:12px;
    }
    .pill{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.55);
      padding: 9px 12px;
      border-radius: 999px;
      display:flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 6px 18px rgba(0,0,0,.05);
      font-weight:600;
    }
    .pill:active{transform:scale(.98)}
    .pill .dot{
      width:10px;height:10px;border-radius:50%;
      background: #31c46f;
      box-shadow: 0 0 0 3px rgba(49,196,111,.15);
    }

    /* Views */
    .view{
      flex:1;
      overflow:auto;
      padding: 6px 14px 14px;
      display:none;
      -webkit-overflow-scrolling: touch;
    }
    .view.active{display:block}

    .card{
      border:1px solid var(--stroke);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
      margin-bottom: 12px;
    }
    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .muted{color:var(--muted)}
    .btn{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      border-radius: 14px;
      padding: 10px 12px;
      font-weight:700;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 6px 18px rgba(0,0,0,.05);
    }
    .btn:active{transform:scale(.98)}
    .btn.primary{
      border-color: rgba(42,124,255,.25);
      background: linear-gradient(180deg, rgba(42,124,255,.16), rgba(255,255,255,.82));
    }
    .btn.orange{
      border-color: rgba(255,179,71,.35);
      background: linear-gradient(180deg, rgba(255,179,71,.20), rgba(255,255,255,.82));
    }

    .list{display:flex; flex-direction:column; gap:10px}
    .item{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.62);
      border-radius: 18px;
      padding: 12px;
      display:flex;
      align-items:center;
      gap:12px;
      cursor:pointer;
      user-select:none;
    }
    .item:active{transform:scale(.99)}
    .avatar{
      width:42px;height:42px;border-radius: 14px;
      display:grid; place-items:center;
      font-weight:900;
      color: #1f4aa3;
      background: rgba(42,124,255,.12);
      border:1px solid rgba(42,124,255,.18);
      flex:0 0 auto;
    }
    .item .meta{
      min-width:0; flex:1;
      display:flex; flex-direction:column; gap:4px;
    }
    .item .meta .name{font-weight:900}
    .item .meta .preview{
      font-size:13px;
      color:var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .badge{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.7);
      color: var(--muted);
      flex:0 0 auto;
    }

    /* Bottom nav */
    .nav{
      position: fixed;
      left:50%;
      transform: translateX(-50%);
      bottom: 10px;
      bottom: calc(10px + var(--safe-bottom));
      width: min(520px, calc(100% - 24px));
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.78);
      backdrop-filter: blur(10px);
      border-radius: 24px;
      box-shadow: var(--shadow);
      display:flex;
      padding: 8px;
      gap: 6px;
      z-index: 50;
    }
    .tab{
      flex:1;
      border-radius: 18px;
      padding: 10px 8px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:4px;
      cursor:pointer;
      user-select:none;
      color: var(--muted);
      font-weight:800;
      font-size:12px;
    }
    .tab.active{
      color: var(--text);
      background: linear-gradient(180deg, rgba(42,124,255,.10), rgba(255,255,255,.65));
      border: 1px solid rgba(42,124,255,.18);
    }
    .ico{font-size:18px; line-height:1}

    /* Chat screen */
    .chatHeader{
      position: sticky;
      top: 0;
      z-index: 5;
      padding: 10px 12px;
      margin: 0 0 10px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.84);
      backdrop-filter: blur(8px);
      border-radius: 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .chatHeader .left{
      display:flex; align-items:center; gap:10px; min-width:0;
    }
    .backBtn{
      width:40px;height:40px;
      border-radius: 14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      display:grid; place-items:center;
      cursor:pointer;
      user-select:none;
    }
    .backBtn:active{transform:scale(.98)}
    .chatTitle{min-width:0}
    .chatTitle .n{font-weight:900}
    .chatTitle .s{font-size:12px;color:var(--muted)}

    .bubbles{
      display:flex;
      flex-direction:column;
      gap:10px;
      padding-bottom: 84px; /* input bar space */
    }
    .bubble{
      max-width: 78%;
      padding: 10px 12px;
      border-radius: 18px;
      border:1px solid var(--stroke);
      box-shadow: 0 6px 18px rgba(0,0,0,.05);
      font-size: 14px;
      line-height: 1.35;
      background: rgba(255,255,255,.75);
      word-wrap: break-word;
    }
    .bubble.me{
      margin-left:auto;
      border-color: rgba(42,124,255,.18);
      background: linear-gradient(180deg, rgba(42,124,255,.14), rgba(255,255,255,.78));
    }
    .bubble .time{
      margin-top:6px;
      font-size:11px;
      color: var(--muted);
      text-align:right;
    }

    .composer{
      position: fixed;
      left:50%;
      transform: translateX(-50%);
      bottom: calc(92px + var(--safe-bottom));
      width: min(520px, calc(100% - 24px));
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.84);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 8px;
      display:none;
      gap:8px;
      z-index: 60;
    }
    .composer.active{display:flex}
    .composer input{
      flex:1;
      border:none;
      outline:none;
      font-size:15px;
      padding: 10px 12px;
      border-radius: 16px;
      background: rgba(255,255,255,.65);
      border:1px solid rgba(0,0,0,.06);
    }
    .sendBtn{
      width:48px;height:48px;
      border-radius: 16px;
      border:1px solid rgba(42,124,255,.22);
      background: linear-gradient(180deg, rgba(42,124,255,.22), rgba(255,255,255,.85));
      cursor:pointer;
      user-select:none;
      font-weight:900;
      display:grid;
      place-items:center;
    }
    .sendBtn:active{transform:scale(.98)}

    /* Modal */
    .modalWrap{
      position: fixed;
      inset:0;
      background: rgba(0,0,0,.25);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding: 14px;
      z-index: 999;
    }
    .modalWrap.show{display:flex}
    .sheet{
      width:min(520px, 100%);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      box-shadow: 0 18px 50px rgba(0,0,0,.18);
      padding: 12px;
    }
    .sheet h3{margin:6px 4px 8px; font-size:16px}
    .sheet .field{
      display:flex; flex-direction:column; gap:6px;
      margin: 10px 4px;
    }
    .sheet label{font-size:12px;color:var(--muted); font-weight:700}
    .sheet input{
      border:1px solid var(--stroke);
      border-radius: 16px;
      padding: 12px;
      font-size: 15px;
      outline: none;
      background: rgba(255,255,255,.8);
    }
    .sheet .actions{
      display:flex;
      gap:10px;
      margin-top: 10px;
      padding: 4px;
    }
    .sheet .actions .btn{flex:1}
    .hint{
      font-size:12px;color:var(--muted); margin: 8px 6px 0;
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="title">
        <h1 id="headerTitle">Mesajlar</h1>
        <small id="headerSub">Basit mesajla≈üma</small>
      </div>
      <div class="pill" id="headerAction">
        <span class="dot"></span>
        <span id="headerActionText">Yeni</span>
        <span style="opacity:.6">Ôºã</span>
      </div>
    </header>

    <!-- ARAMALAR -->
    <section class="view" id="view-calls" aria-label="Aramalar">
      <div class="card">
        <div class="row">
          <div>
            <div style="font-weight:900">Aramalar</div>
            <div class="muted" style="font-size:13px">Son aramalar burada g√∂r√ºnecek (demo).</div>
          </div>
          <button class="btn orange" id="btnAddCall">+ Arama</button>
        </div>
      </div>
      <div class="list" id="callsList"></div>
    </section>

    <!-- DURUM -->
    <section class="view" id="view-status" aria-label="Durum">
      <div class="card">
        <div class="row">
          <div>
            <div style="font-weight:900">Durum</div>
            <div class="muted" style="font-size:13px">Buraya hikaye/durum mantƒ±ƒüƒ± eklenir (demo).</div>
          </div>
          <button class="btn orange" id="btnAddStatus">+ Durum</button>
        </div>
      </div>
      <div class="list" id="statusList"></div>
    </section>

    <!-- MESAJLAR -->
    <section class="view active" id="view-chats" aria-label="Mesajlar">
      <div class="card">
        <div style="font-weight:900">Mesajlar</div>
        <div class="muted" style="font-size:13px">Bir sohbet se√ß ‚Äî mesaj yazƒ±p g√∂nderebilirsin.</div>
      </div>
      <div class="list" id="chatList"></div>
    </section>

    <!-- PROFIL -->
    <section class="view" id="view-profile" aria-label="Profil">
      <div class="card">
        <div style="font-weight:900">Profil</div>
        <div class="muted" style="font-size:13px">Basit profil ekranƒ± (demo).</div>
      </div>

      <div class="list">
        <div class="item" id="meCard">
          <div class="avatar">üôÇ</div>
          <div class="meta">
            <div class="name" id="meName">Engin</div>
            <div class="preview" id="meStatus">Durum: √ßevrimi√ßi</div>
          </div>
          <div class="badge">Ayarla</div>
        </div>

        <div class="item" id="settingsCard">
          <div class="avatar">‚öôÔ∏è</div>
          <div class="meta">
            <div class="name">Ayarlar</div>
            <div class="preview">Bildirim / Gizlilik (demo)</div>
          </div>
          <div class="badge">‚Üí</div>
        </div>

        <div class="card">
          <div class="row">
            <div>
              <div style="font-weight:900">Veriler</div>
              <div class="muted" style="font-size:13px">Bu demo cihazda saklanƒ±r (localStorage).</div>
            </div>
            <button class="btn" id="btnReset">Sƒ±fƒ±rla</button>
          </div>
          <div class="hint">Not: Bu s√ºr√ºm ger√ßek kullanƒ±cƒ±larla mesajla≈ümaz. Sonraki adƒ±mda Firebase eklenir.</div>
        </div>
      </div>
    </section>

    <!-- CHAT (tek sohbet ekranƒ±) -->
    <section class="view" id="view-chat" aria-label="Sohbet">
      <div class="chatHeader">
        <div class="left">
          <div class="backBtn" id="btnBack">‚Üê</div>
          <div class="chatTitle">
            <div class="n" id="chatWithName">Ki≈üi</div>
            <div class="s" id="chatWithSub">√áevrimi√ßi</div>
          </div>
        </div>
        <div class="badge" id="chatBadge">Sohbet</div>
      </div>
      <div class="bubbles" id="bubbleList"></div>
    </section>
  </div>

  <!-- Composer -->
  <div class="composer" id="composer">
    <input id="msgInput" type="text" placeholder="Mesaj yaz..." autocomplete="off"/>
    <div class="sendBtn" id="btnSend">‚û§</div>
  </div>

  <!-- Modal -->
  <div class="modalWrap" id="modalWrap" role="dialog" aria-modal="true">
    <div class="sheet">
      <h3 id="modalTitle">Yeni</h3>
      <div class="field">
        <label id="modalLabel">ƒ∞sim</label>
        <input id="modalInput" type="text" placeholder="Yaz..."/>
      </div>
      <div class="actions">
        <button class="btn" id="modalCancel">Vazge√ß</button>
        <button class="btn primary" id="modalOk">Kaydet</button>
      </div>
      <div class="hint" id="modalHint"></div>
    </div>
  </div>

  <!-- Bottom Nav -->
  <nav class="nav" aria-label="Alt Men√º">
    <div class="tab" data-tab="calls">
      <div class="ico">üë•</div>
      <div>Aramalar</div>
    </div>
    <div class="tab" data-tab="status">
      <div class="ico">‚ùó</div>
      <div>Durum</div>
    </div>
    <div class="tab active" data-tab="chats">
      <div class="ico">üí¨</div>
      <div>Mesajlar</div>
    </div>
    <div class="tab" data-tab="profile">
      <div class="ico">ü§î</div>
      <div>Profil</div>
    </div>
  </nav>

  <script>
    // ========== STATE ==========
    const KEY = "vigo_chat_demo_v1";
    const state = load() || seed();

    function seed(){
      return {
        me: { name: "Engin", status: "√ßevrimi√ßi" },
        chats: [
          { id:"ahmet", name:"Ahmet", last:"Nasƒ±lsƒ±n?", online:true, messages:[
            { by:"them", text:"Nasƒ±lsƒ±n?", ts: Date.now()-1000*60*40 },
            { by:"me", text:"ƒ∞yiyim, sen?", ts: Date.now()-1000*60*38 }
          ]},
          { id:"zeynep", name:"Zeynep", last:"Yarƒ±n g√∂r√º≈ü√ºr√ºz.", online:false, messages:[
            { by:"them", text:"Yarƒ±n g√∂r√º≈ü√ºr√ºz.", ts: Date.now()-1000*60*60*5 }
          ]},
          { id:"mert", name:"Mert", last:"Tamamdƒ±r.", online:true, messages:[
            { by:"them", text:"Tamamdƒ±r.", ts: Date.now()-1000*60*10 }
          ]},
        ],
        calls: [
          { id: cryptoId(), name:"Ahmet", when: "Bug√ºn 12:05", type:"Gelen" },
          { id: cryptoId(), name:"Zeynep", when: "D√ºn 21:18", type:"Giden" },
        ],
        statuses: [
          { id: cryptoId(), name:"Senin durumun", text:"Durum ekle", mine:true },
          { id: cryptoId(), name:"Ahmet", text:"‚ÄúDƒ±≈üarƒ±dayƒ±m‚Äù", mine:false },
        ],
        ui: { activeTab:"chats", activeChatId:null }
      };
    }

    function load(){
      try{
        const raw = localStorage.getItem(KEY);
        if(!raw) return null;
        return JSON.parse(raw);
      }catch(e){ return null; }
    }
    function save(){
      localStorage.setItem(KEY, JSON.stringify(state));
    }
    function cryptoId(){
      return Math.random().toString(16).slice(2) + Date.now().toString(16);
    }

    // ========== DOM ==========
    const headerTitle = document.getElementById("headerTitle");
    const headerSub   = document.getElementById("headerSub");
    const headerAction= document.getElementById("headerAction");
    const headerActionText = document.getElementById("headerActionText");

    const views = {
      calls: document.getElementById("view-calls"),
      status: document.getElementById("view-status"),
      chats: document.getElementById("view-chats"),
      profile: document.getElementById("view-profile"),
      chat: document.getElementById("view-chat"),
    };

    const tabs = Array.from(document.querySelectorAll(".tab"));

    const chatList = document.getElementById("chatList");
    const callsList = document.getElementById("callsList");
    const statusList = document.getElementById("statusList");

    const composer = document.getElementById("composer");
    const msgInput = document.getElementById("msgInput");
    const btnSend = document.getElementById("btnSend");
    const btnBack = document.getElementById("btnBack");
    const bubbleList = document.getElementById("bubbleList");
    const chatWithName = document.getElementById("chatWithName");
    const chatWithSub = document.getElementById("chatWithSub");

    const meName = document.getElementById("meName");
    const meStatus = document.getElementById("meStatus");

    // Modal
    const modalWrap = document.getElementById("modalWrap");
    const modalTitle = document.getElementById("modalTitle");
    const modalLabel = document.getElementById("modalLabel");
    const modalInput = document.getElementById("modalInput");
    const modalHint  = document.getElementById("modalHint");
    const modalCancel = document.getElementById("modalCancel");
    const modalOk = document.getElementById("modalOk");

    // Buttons
    document.getElementById("btnAddCall").addEventListener("click", () => openModal({
      title:"Yeni Arama",
      label:"Ki≈üi adƒ±",
      placeholder:"√ñrn: Hasan",
      hint:"Demo: Arama listesine ekler.",
      onOk:(val)=>{
        if(!val.trim()) return;
        state.calls.unshift({ id: cryptoId(), name: val.trim(), when:"≈ûimdi", type:"Giden" });
        save(); renderCalls();
      }
    }));

    document.getElementById("btnAddStatus").addEventListener("click", () => openModal({
      title:"Durum Ekle",
      label:"Durum",
      placeholder:"Ne yapƒ±yorsun?",
      hint:"Demo: Kendi durumunu g√ºnceller.",
      onOk:(val)=>{
        if(!val.trim()) return;
        // mine status is first item
        const mine = state.statuses.find(s => s.mine);
        mine.text = val.trim();
        save(); renderStatus();
      }
    }));

    document.getElementById("btnReset").addEventListener("click", () => {
      localStorage.removeItem(KEY);
      location.reload();
    });

    document.getElementById("meCard").addEventListener("click", () => openModal({
      title:"Profil",
      label:"Adƒ±n",
      placeholder:"Adƒ±nƒ± yaz",
      initial: state.me.name,
      hint:"Demo: Ba≈ülƒ±ƒüƒ± ve profilini g√ºnceller.",
      onOk:(val)=>{
        if(!val.trim()) return;
        state.me.name = val.trim();
        save(); renderProfile();
      }
    }));

    document.getElementById("settingsCard").addEventListener("click", () => {
      alert("Ayarlar (demo) ‚Äî ƒ∞stersen sonraki adƒ±mda ger√ßek ayar ekranƒ± ekleriz.");
    });

    // Header action changes per tab
    headerAction.addEventListener("click", () => {
      const t = state.ui.activeTab;
      if(t === "chats"){
        openModal({
          title:"Yeni Sohbet",
          label:"Ki≈üi adƒ±",
          placeholder:"√ñrn: Ece",
          hint:"Demo: Sohbet listesine yeni ki≈üi ekler.",
          onOk:(val)=>{
            if(!val.trim()) return;
            const name = val.trim();
            const id = name.toLowerCase().replace(/\s+/g,"-") + "-" + cryptoId().slice(0,4);
            state.chats.unshift({ id, name, last:"", online:true, messages:[] });
            save(); renderChats();
          }
        });
      } else if(t === "status"){
        document.getElementById("btnAddStatus").click();
      } else if(t === "calls"){
        doc
